<!DOCTYPE html>
<html lang="en">
  <head>
    {% load static %}
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Plant Temperature</title>
    <link
      rel="stylesheet"
      href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css"
    />
    <style>
      /* Custom background gradient for the body */
      body {
        background: linear-gradient(135deg, #e0f7fa, #aed581);
        color: #34495e;
      }
      .card {
        border-radius: 50px;
        overflow: hidden;
      }
      .card-header {
        background-color: #43a047;
        color: #ffffff;
        font-size: 1.5rem;
      }
      .card-body {
        background-color: #ffffff;
        color: #34495e;
      }
      .card-footer {
        background-color: #e8f5e9;
        color: #388e3c;
      }
      .temperature {
        font-size: 3rem;
        font-weight: bold;
        color: #ff7043;
      }
      .timestamp {
        font-size: 1rem;
        color: #607d8b;
      }

      /* Animation for the plant image */
      .animated-plant {
        width: 500px;
        height: 700px;
        justify-content: center;
        align-items: center;
        animation: grow-shrink 3s ease-in-out infinite;
        transition: transform 0.3s ease;
      }

      /* Plant image grows and shrinks */
      @keyframes grow-shrink {
        0%,
        100% {
          transform: scale(1);
        }
        50% {
          transform: scale(1.05);
        }
      }

      /* Hover effect for the plant image */
      .animated-plant:hover {
        transform: scale(1.5) rotate(12deg);
        cursor: pointer;
      }

      /* Hover effect for header image */
      .header-img {
        width: 50px;
        height: 75px;
        transition: transform 0.3s ease;
      }

      .header-img:hover {
        transform: scale(1.2) rotate(-10deg);
      }
    </style>
  </head>
  <body>
    <div class="container mt-5 mb-5">
        <div class="card shadow-lg">
            <div class="card-header mb-5 text-center">
                <img src="{% static 'images/flower.png' %}" class="header-img" alt="Flower emoji"> PlantPal 
            </div>
            <div class="container mt-5">
                <div class="row align-items-center">
                    <!-- Primera columna -->
                    <div class="col-md-6 mb-4">
                        <div class="p-4 rounded shadow-lg bg-light h-100">
                            <form method="post">
                                {% csrf_token %}
                                <div class="form-group">
                                    <label for="name" class="font-weight-bold mb-2">Name of the Plant:</label>
                                    <input type="text" id="name" name="name" class="form-control form-control-lg rounded-pill shadow-sm" placeholder="Enter plant name" required>
                                </div>
                                <button type="submit" class="btn btn-success btn-md mt-3 w-100 rounded-pill shadow">Submit</button>
                            </form>
                        </div>
                        <form method="post" action="{% url 'main' %}">
                          <div class="p-4 rounded shadow-lg bg-light mt-5 mb-5 h-20" >
                            <div class="d-flex justify-content-center">
                                <select class="form-select form-select-lg mb-3" name="selected_plant">
                                    <option selected>Select the type of your plant</option>
                                    {% for plant in plants %}
                                        <option value="{{ plant.id }}">{{plant.specie}}</option>
                                    {% endfor %}
                                </select>
                            </div>
                        </div>  
                         
                    </div>
                    <!-- Segunda columna -->
                    <div class="col-md-6 mb-4">
                        <div class="p-4 rounded shadow-lg bg-light h-100 d-flex justify-content-center align-items-center">
                            <p class="text-center">  
                                <strong>PlantPal</strong> is designed to help you monitor, nurture, and thrive with your plants.
                                With real-time insights, PlantPal makes plant care easy and enjoyable for everyone.
                                Whether you're a seasoned gardener or a beginner, we've got you covered!
                            </p>
                        </div>
                            {% csrf_token %}
                            <div class="p-4 rounded shadow-lg bg-light mt-5 mb-5">
                                <div class="d-flex justify-content-center">
                                    <select class="form-select form-select-lg mb-3" name="selected_color">
                                        <option selected disabled>Select the color of your Plant</option>
                                        <option value="Yellow">Yellow</option>
                                        <option value="Green">Green</option>
                                        <option value="Red">Red</option>
                                        <option value="Pink">Pink</option>
                                        <option value="Purple">Purple</option>
                                    </select>
                                </div>
                                <button type="submit" class="btn btn-primary">Save Color</button>
                            </div>
                        </form>                            
                    </div>
                </div>     
                    
                {% if plant_name %}
                    <p class="text-center mt-5"><strong>Monitoring Plant: {{ plant_name }}</strong></p>
                {% else %}
                    <p>No plant name provided yet.</p>
                {% endif %}
            </div> 
            <div class="container mt-5 mb-5">
                <div class="row">
                    <div class="col-md-6 mb-4">
                        <h4 class="card-title text-center">Latest Temperature Reading</h4>
                        <p class="temperature">
                          {% if selected_plant == "1" %}
                          <div>ok</div>
                              {% if selected_color == "Yellow" %}
                                  <img src="{% static 'images/yellowCheesePlant.png' %}" alt="Yellow" id="plantImage1" class="animated-plant">
                              {% elif selected_color == "Green" %}
                                  <img src="{% static 'images/greenSwissCheese.png' %}" alt="Green" id="plantImage2" class="animated-plant">
                              {% elif selected_color == "Red" %}
                                  <img src="{% static 'images/redSwissCheese.png' %}" alt="Red" id="plantImage3" class="animated-plant">
                              {% elif selected_color == "Pink" %}
                                  <img src="{% static 'images/pinkSwissCheese.png' %}" alt="Pink" id="plantImage4" class="animated-plant">
                              {% else %}
                                  <img src="{% static 'images/purpleSwissCheese.png' %}" alt="Purple" id="plantImage5" class="animated-plant">
                              {% endif %}
                          
                          {% elif selected_plant == "2" %}
                              {% if selected_color == "Yellow" %}
                                  <img src="{% static 'images/yellowRubberPlant.png' %}" alt="Yellow2" id="plantImage6" class="animated-plant">
                              {% elif selected_color == "Green" %}
                                  <img src="{% static 'images/greenRubberPlant.png' %}" alt="Green2" id="plantImage7" class="animated-plant">
                              {% elif selected_color == "Red" %}
                                  <img src="{% static 'images/redRubberPlant.png' %}" alt="Red2" id="plantImage8" class="animated-plant">
                              {% elif selected_color == "Pink" %}
                                  <img src="{% static 'images/pinkRubberPlant.png' %}" alt="Pink2" id="plantImage9" class="animated-plant">
                              {% else %}
                                  <img src="{% static 'images/purpleRubberPlant.png' %}" alt="Purple2" id="plantImage10" class="animated-plant">
                              {% endif %}
                            {% elif selected_plant == "3" %}
                              {% if selected_color == "Yellow" %}
                                  <img src="{% static 'images/yellowRubberPlant.png' %}" alt="Yellow2" id="plantImage6" class="animated-plant">
                              {% elif selected_color == "Green" %}
                                  <img src="{% static 'images/greenRubberPlant.png' %}" alt="Green2" id="plantImage7" class="animated-plant">
                              {% elif selected_color == "Red" %}
                                  <img src="{% static 'images/redRubberPlant.png' %}" alt="Red2" id="plantImage8" class="animated-plant">
                              {% elif selected_color == "Pink" %}
                                  <img src="{% static 'images/pinkRubberPlant.png' %}" alt="Pink2" id="plantImage9" class="animated-plant">
                              {% else %}
                                  <img src="{% static 'images/purpleRubberPlant.png' %}" alt="Purple2" id="plantImage10" class="animated-plant">
                              {% endif %}
                          {% endif %}
                        </p>
                    </div>
                </div>
            </div>
            
                <div class="col-md-6 mb-4">
                    <div class="p-4 text-center">
                        <div id="temperature">ðŸŒ± Temperature: -- Â°C</div>
                        <div id="air_humidity">ðŸŒ± Air Humidity: -- %</div>
                        <div id="soil_humidity">ðŸŒ± Soil Humidity: -- %</div>
                        <div id="timestamp">ðŸŒ± Timestamp: --</div>
                    </div>
                </div>
                </div>
            </div>
        </div>

    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.0.7/dist/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
    <script>
      let seconds = 0;
      function checkTemperature(value) {
        // Use backticks for string interpolation
        document.getElementById(
          "temperatureValue"
        ).textContent = `Current Temperature: ${value} Â°C`;

        const plantImage = document.getElementById("plantImage");

        if (value < 15) {
          plantImage.style.transform = "scale(0.3)";
        } else {
          plantImage.style.transform = "scale(1)";
        }
      }
      function fetchData() {
        seconds+=1;
        fetch("{% url 'main' %}", {
          headers: {
            "X-Requested-With": "XMLHttpRequest",
          },
        })
          .then((response) => response.json())
          .then((data) => {
            document.getElementById(
              "temperature"
            ).textContent = `ðŸŒ± Temperature: ${data.temperature} Â°C`;
            document.getElementById(
              "air_humidity"
            ).textContent = `ðŸŒ± Air Humidity: ${data.air_humidity}%`;
            document.getElementById(
              "soil_humidity"
            ).textContent = `ðŸŒ± Soil Humidity: ${data.soil_humidity}%`;
            document.getElementById(
              "timestamp"
            ).textContent = `ðŸŒ± Timestamp: ${data.timestamp}`;
          })
          .catch((error) => console.error("Error:", error));
      }

      // Llamar a fetchData cada 15 segundos
      setInterval(fetchData, 15000);
    </script>
  </body>
</html>
